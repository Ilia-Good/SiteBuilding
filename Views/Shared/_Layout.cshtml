@using System.Security.Claims
@inject IConfiguration Configuration
<!DOCTYPE html>
<html lang="ru">
<head>
    @{
        var googleSiteVerification = Configuration["GOOGLE_SITE_VERIFICATION"];
        var googleAdsenseAccount = "ca-pub-8773683201595025";
    }
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@(string.IsNullOrWhiteSpace(ViewData["Title"] as string) ? "SiteBuilding - конструктор сайтов" : $"{ViewData["Title"]} | SiteBuilding")</title>

    <meta name="description" content="SiteBuilding - конструктор мини-сайтов. Быстро собери сайт и опубликуй." />
    <link rel="canonical" href="https://sitebuilding.onrender.com/" />
    <meta name="robots" content="index,follow" />

    <meta property="og:title" content="SiteBuilding - конструктор сайтов" />
    <meta property="og:description" content="Соберите мини-сайт за минуты и опубликуйте." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://sitebuilding.onrender.com/" />
    <meta property="og:image" content="https://sitebuilding.onrender.com/android-chrome-512x512.png" />
    <meta name="google-adsense-account" content="@googleAdsenseAccount" />
    @if (!string.IsNullOrWhiteSpace(googleSiteVerification))
    {
        <meta name="google-site-verification" content="@googleSiteVerification" />
    }

    <link rel="icon" type="image/x-icon" sizes="any" href="~/favicon.ico" asp-append-version="true" />
    <link rel="icon" type="image/png" sizes="32x32" href="~/favicon-32x32.png" asp-append-version="true" />
    <link rel="icon" type="image/png" sizes="16x16" href="~/favicon-16x16.png" asp-append-version="true" />
    <link rel="apple-touch-icon" sizes="180x180" href="~/apple-touch-icon.png" asp-append-version="true" />
    <link rel="manifest" href="~/site.webmanifest" asp-append-version="true" />
    <script type="importmap"></script>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/SiteBuilder.styles.css" asp-append-version="true" />
    @await RenderSectionAsync("Ads", required: false)
    @await RenderSectionAsync("Styles", required: false)
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg app-navbar mb-3">
            <div class="container-fluid">
                <a class="navbar-brand app-navbar-brand" asp-area="" asp-controller="Home" asp-action="Index">
                    <span class="app-logo-dot"></span>
                    SiteBuilding
                </a>
                <button class="navbar-toggler app-navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#appMainNav"
                        aria-controls="appMainNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse app-navbar-collapse" id="appMainNav">
                    <div class="app-navbar-links d-flex flex-column flex-lg-row">
                        <a class="nav-link app-nav-btn" data-i18n="nav_home" asp-area="" asp-controller="Home" asp-action="Index">Главная</a>
                        <a class="nav-link app-nav-btn" data-i18n="nav_builder" asp-area="" asp-controller="Builder" asp-action="Index">Конструктор</a>
                        <a class="nav-link app-nav-btn" data-i18n="nav_all_sites" asp-area="" asp-controller="PublicSites" asp-action="Index">Все сайты</a>
                        <a class="nav-link app-nav-btn" data-i18n="nav_my_sites" asp-area="" asp-controller="Sites" asp-action="Index">Мои сайты</a>
                    </div>
                    <div class="app-navbar-actions d-flex align-items-stretch align-items-lg-center gap-2">
                        @if (User?.Identity?.IsAuthenticated ?? false)
                        {
                            var email = User.FindFirstValue(ClaimTypes.Email);
                            var nick = string.IsNullOrWhiteSpace(email) ? "друг" : email.Split('@')[0];
                            @await Component.InvokeAsync("UserSitesMenu")
                            <span class="app-user-email"><span data-i18n="hello">Привет</span>, @nick</span>
                            <form method="post" asp-controller="Account" asp-action="Logout">
                                <button type="submit" class="btn btn-outline-light app-nav-btn" data-i18n="btn_logout">Выйти</button>
                            </form>
                        }
                        else
                        {
                            <a class="btn btn-outline-light app-nav-btn" data-i18n="btn_login_google" asp-controller="Account" asp-action="Login">Войти через Google</a>
                        }
                        <button id="uiSettingsToggle" type="button" class="btn btn-outline-light app-nav-btn" data-i18n="btn_ui_settings">Настройки вида</button>
                    </div>
                </div>
            </div>
        </nav>
    </header>
    <div class="container">
        <main role="main" class="pb-3">
            @RenderBody()
        </main>
    </div>
    <footer class="container pb-4 app-footer">
        <div class="app-footer-links small text-muted">
            <a data-i18n="footer_privacy" asp-controller="Home" asp-action="Privacy">Конфиденциальность</a>
            <a data-i18n="footer_terms" asp-controller="Home" asp-action="Terms">Условия</a>
            <a data-i18n="footer_about" href="/about#about">О проекте</a>
            <a data-i18n="footer_faq" href="/about#faq">FAQ</a>
            <a data-i18n="footer_guides" href="/about#guides">Гайды</a>
            <a data-i18n="footer_contact" href="/about#contact">Контакты</a>
            <a data-i18n="footer_all_sites" href="/explore">Все сайты</a>
        </div>
        <div class="app-footer-copy">2026 ©Goods</div>
    </footer>

    <div id="uiSettingsMenu" class="ui-settings-menu d-none" aria-hidden="true">
        <div class="ui-settings-title" data-i18n="settings_title">Настройки интерфейса</div>
        <label class="ui-settings-label" for="uiLanguage" data-i18n="settings_language">Язык</label>
        <select id="uiLanguage" class="form-select form-select-sm mb-2">
            <option value="ru" data-i18n="lang_ru">Русский</option>
            <option value="en" data-i18n="lang_en">English</option>
            <option value="es" data-i18n="lang_es">Español</option>
        </select>

        <label class="ui-settings-label" for="uiTheme" data-i18n="settings_theme">Фон</label>
        <select id="uiTheme" class="form-select form-select-sm mb-2">
            <option value="aurora" data-i18n="theme_aurora">Aurora</option>
            <option value="sunset" data-i18n="theme_sunset">Sunset</option>
            <option value="ocean" data-i18n="theme_ocean">Ocean</option>
            <option value="mono" data-i18n="theme_mono">Mono</option>
        </select>

        <label class="ui-settings-label" for="uiEffects" data-i18n="settings_effects">Эффекты</label>
        <select id="uiEffects" class="form-select form-select-sm mb-1">
            <option value="none" data-i18n="fx_none">Нет</option>
            <option value="glass" data-i18n="fx_glass">Стекло</option>
            <option value="glow" data-i18n="fx_glow">Свечение</option>
        </select>
        <div class="ui-settings-hint" data-i18n="settings_effects_hint">Стекло: мягкие полупрозрачные панели. Свечение: яркий акцент.</div>

        <label class="ui-settings-label mt-2" for="uiScale" data-i18n="settings_text_size">Размер текста</label>
        <input id="uiScale" class="form-range mb-0" type="range" min="0.8" max="1.3" step="0.01" value="1" />
        <div id="uiScaleValue" class="ui-scale-value">100%</div>

        <div class="form-check form-switch mb-2 mt-2">
            <input class="form-check-input" type="checkbox" id="uiCompact" />
            <label class="form-check-label" for="uiCompact" data-i18n="settings_compact">Компактный режим</label>
        </div>

        <button id="uiSurprise" type="button" class="btn btn-sm btn-primary w-100 mb-2" data-i18n="settings_surprise">Удиви меня</button>
        <button id="uiReset" type="button" class="btn btn-sm btn-outline-light w-100" data-i18n="settings_reset">Сбросить</button>
    </div>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>


